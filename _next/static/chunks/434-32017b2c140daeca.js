"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[434],{53291:e=>{var t,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,i){var n;function s(r){e.removeListener(t,a),i(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",s),r([].slice.call(arguments))}y(e,t,a,{once:!0}),"error"!==t&&(n={once:!0},"function"==typeof e.on&&y(e,"error",s,n))})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,r,i){if(o(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),a=s[t]),void 0===a)a=s[t]=r,++e._eventsCount;else if("function"==typeof a?a=s[t]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),(n=d(e))>0&&a.length>n&&!a.warned){a.warned=!0;var n,s,a,c=Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=l.bind(i);return n.listener=r,i.wrapFn=n,n}function h(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):f(n,n.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}function y(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function n(s){i.once&&e.removeEventListener(t,n),r(s)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||n(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return d(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var a,o=Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var d=s[e];if(void 0===d)return!1;if("function"==typeof d)i(d,this,t);else for(var c=d.length,l=f(d,c),r=0;r<c;++r)i(l[r],this,t);return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return o(t),this.on(e,u(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,u(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,i,n,s,a;if(o(t),void 0===(i=this._events)||void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){a=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)"removeListener"!==(n=s[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},39883:(e,t,r)=>{let i;r.d(t,{Yo:()=>u});let n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",s="http://www.w3.org/2001/XMLSchema#",a="http://www.w3.org/2000/10/swap/",{rdf:o,xsd:d}={xsd:{decimal:`${s}decimal`,boolean:`${s}boolean`,double:`${s}double`,integer:`${s}integer`,string:`${s}string`},rdf:{type:`${n}type`,nil:`${n}nil`,first:`${n}first`,rest:`${n}rest`,langString:`${n}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${a}reify#forSome`,forAll:`${a}reify#forAll`},log:{implies:`${a}log#implies`}},c=0;class l{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof l?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class u extends l{get termType(){return"NamedNode"}}class h extends l{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){let e=this.id,t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new u(this.datatypeString)}get datatypeString(){let e=this.id,t=e.lastIndexOf('"')+1,r=t<e.length?e[t]:"";return"^"===r?e.substr(t+2):"@"!==r?d.string:o.langString}equals(e){return e instanceof h?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class p extends l{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class f extends l{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class y extends l{constructor(){return super(""),i||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}i=new y;class m extends l{constructor(e,t,r,n){super(""),this._subject=e,this._predicate=t,this._object=r,this._graph=n||i}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function g(e){if(e instanceof l)return e;switch(e.termType){case"NamedNode":return new u(e.value);case"BlankNode":return new p(e.value||`n3-${c++}`);case"Variable":return new f(e.value);case"DefaultGraph":return i;case"Literal":return function(e,t){if("string"==typeof t)return new h(`"${e}"@${t.toLowerCase()}`);let r=t?t.value:"";return""!==r||("boolean"==typeof e?r=d.boolean:"number"!=typeof e||(Number.isFinite(e)?r=Number.isInteger(e)?d.integer:d.double:(r=d.double,Number.isNaN(e)||(e=e>0?"INF":"-INF")))),new h(""===r||r===d.string?`"${e}"`:`"${e}"^^${r}`)}(e.value,e.language||e.datatype);case"Quad":return function(e){var t,r,i;if(e instanceof m)return e;if("Quad"!==e.termType)throw Error(`Unexpected termType: ${e.termType}`);return t=g(e.subject),r=g(e.predicate),i=g(e.object),new m(t,r,i,g(e.graph))}(e);default:throw Error(`Unexpected termType: ${e.termType}`)}}},51464:(e,t,r)=>{var i=r(62456);r.o(i,"usePathname")&&r.d(t,{usePathname:function(){return i.usePathname}}),r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}}),r.o(i,"useSearchParams")&&r.d(t,{useSearchParams:function(){return i.useSearchParams}})},82635:(e,t,r)=>{r.d(t,{AU:()=>s,Bd:()=>a,lQ:()=>i,on:()=>n});var i=function(){};function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&e.addEventListener&&e.addEventListener.apply(e,t)}function s(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}var a="undefined"!=typeof window},45633:(e,t,r)=>{r.d(t,{A:()=>n});var i=r(56389);let n=function(e){(0,i.useEffect)(e,[])}},44573:(e,t,r)=>{r.d(t,{A:()=>s});var i=r(56389),n=r(82635);let s=function(e,t,r){if(!n.Bd)return[t,n.lQ,n.lQ];if(!e)throw Error("useLocalStorage key may not be falsy");var s=r?r.raw?function(e){return e}:r.deserializer:JSON.parse,a=(0,i.useRef)(function(e){try{var i=r?r.raw?String:r.serializer:JSON.stringify,n=localStorage.getItem(e);if(null!==n)return s(n);return t&&localStorage.setItem(e,i(t)),t}catch(e){return t}}),o=(0,i.useState)(function(){return a.current(e)}),d=o[0],c=o[1];(0,i.useLayoutEffect)(function(){return c(a.current(e))},[e]);var l=(0,i.useCallback)(function(t){try{var i="function"==typeof t?t(d):t;if(void 0===i)return;var n=void 0;n=r?r.raw?"string"==typeof i?i:JSON.stringify(i):r.serializer?r.serializer(i):JSON.stringify(i):JSON.stringify(i),localStorage.setItem(e,n),c(s(n))}catch(e){}},[e,c]);return[d,l,(0,i.useCallback)(function(){try{localStorage.removeItem(e),c(void 0)}catch(e){}},[e,c])]}},8212:(e,t,r)=>{let i,n,s,a,o;r.d(t,{_:()=>tH,iD:()=>tF});let d=new TextEncoder,c=new TextDecoder;function l(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;for(let i of e)t.set(i,r),r+=i.length;return t}let u=e=>{let t=e;"string"==typeof t&&(t=d.encode(t));let r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))},h=e=>u(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),p=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r},f=e=>{let t=e;t instanceof Uint8Array&&(t=c.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return p(t)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}};class y extends Error{constructor(e,t){super(e,t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}y.code="ERR_JOSE_GENERIC";class m extends y{constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=i,this.payload=t}}m.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class g extends y{constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=i,this.payload=t}}g.code="ERR_JWT_EXPIRED";class v extends y{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}v.code="ERR_JOSE_ALG_NOT_ALLOWED";class _ extends y{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}_.code="ERR_JOSE_NOT_SUPPORTED";class w extends y{constructor(e="decryption operation failed",t){super(e,t),this.code="ERR_JWE_DECRYPTION_FAILED"}}w.code="ERR_JWE_DECRYPTION_FAILED";class b extends y{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}}b.code="ERR_JWE_INVALID";class S extends y{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}S.code="ERR_JWS_INVALID";class k extends y{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}k.code="ERR_JWT_INVALID";class E extends y{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}}E.code="ERR_JWK_INVALID";class T extends y{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}}T.code="ERR_JWKS_INVALID";class x extends y{constructor(e="no applicable key found in the JSON Web Key Set",t){super(e,t),this.code="ERR_JWKS_NO_MATCHING_KEY"}}x.code="ERR_JWKS_NO_MATCHING_KEY";class I extends y{constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}Symbol.asyncIterator,I.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class A extends y{constructor(e="request timed out",t){super(e,t),this.code="ERR_JWKS_TIMEOUT"}}A.code="ERR_JWKS_TIMEOUT";class R extends y{constructor(e="signature verification failed",t){super(e,t),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}function O(e,t){let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":return{name:"Ed25519"};case"EdDSA":return{name:t.name};default:throw new _(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}R.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";let P=crypto,C=e=>e instanceof CryptoKey,N=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}};function U(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function $(e,t){return e.name===t}function j(e){return parseInt(e.name.slice(4),10)}function L(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let D=(e,...t)=>L("Key must be ",e,...t);function Z(e,t,...r){return L(`Key for the ${e} algorithm must be `,t,...r)}let K=e=>!!C(e)||e?.[Symbol.toStringTag]==="KeyObject",H=["CryptoKey"];function F(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function M(e){return F(e)&&"string"==typeof e.kty}let W=async e=>{if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=function(e){let t,r;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"Ed25519":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new _('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),i=[t,e.ext??!1,e.key_ops??r],n={...e};return delete n.alg,delete n.use,P.subtle.importKey("jwk",n,...i)},J=e=>f(e),V=e=>e?.[Symbol.toStringTag]==="KeyObject",z=async(e,t,r,i,n=!1)=>{let s=e.get(t);if(s?.[i])return s[i];let a=await W({...r,alg:i});return n&&Object.freeze(t),s?s[i]=a:e.set(t,{[i]:a}),a},q={normalizePublicKey:(e,t)=>{if(V(e)){let r=e.export({format:"jwk"});return(delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k)?J(r.k):(n||(n=new WeakMap),z(n,e,r,t))}return M(e)?e.k?f(e.k):(n||(n=new WeakMap),z(n,e,e,t,!0)):e},normalizePrivateKey:(e,t)=>{if(V(e)){let r=e.export({format:"jwk"});return r.k?J(r.k):(i||(i=new WeakMap),z(i,e,r,t))}return M(e)?e.k?f(e.k):(i||(i=new WeakMap),z(i,e,e,t,!0)):e}};async function B(e,t,r){if("sign"===r&&(t=await q.normalizePrivateKey(t,e)),"verify"===r&&(t=await q.normalizePublicKey(t,e)),C(t))return!function(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!$(e.algorithm,"HMAC"))throw U("HMAC");let r=parseInt(t.slice(2),10);if(j(e.algorithm.hash)!==r)throw U(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!$(e.algorithm,"RSASSA-PKCS1-v1_5"))throw U("RSASSA-PKCS1-v1_5");let r=parseInt(t.slice(2),10);if(j(e.algorithm.hash)!==r)throw U(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!$(e.algorithm,"RSA-PSS"))throw U("RSA-PSS");let r=parseInt(t.slice(2),10);if(j(e.algorithm.hash)!==r)throw U(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw U("Ed25519 or Ed448");break;case"Ed25519":if(!$(e.algorithm,"Ed25519"))throw U("Ed25519");break;case"ES256":case"ES384":case"ES512":{if(!$(e.algorithm,"ECDSA"))throw U("ECDSA");let r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw U(r,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}(function(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}})(e,r)}(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError(D(t,...H));return P.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw TypeError(D(t,...H,"Uint8Array","JSON Web Key"))}let G=async(e,t,r,i)=>{let n=await B(e,t,"verify");N(e,n);let s=O(e,n.algorithm);try{return await P.subtle.verify(s,n,r,i)}catch{return!1}},X=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0},Y=e=>e?.[Symbol.toStringTag],Q=(e,t,r)=>{if(void 0!==t.use&&"sig"!==t.use)throw TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&t.key_ops.includes?.(r)!==!0)throw TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(void 0!==t.alg&&t.alg!==e)throw TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0},ee=(e,t,r,i)=>{if(!(t instanceof Uint8Array)){if(i&&M(t)){if(function(e){return M(e)&&"oct"===e.kty&&"string"==typeof e.k}(t)&&Q(e,t,r))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!K(t))throw TypeError(Z(e,t,...H,"Uint8Array",i?"JSON Web Key":null));if("secret"!==t.type)throw TypeError(`${Y(t)} instances for symmetric algorithms must be of type "secret"`)}},et=(e,t,r,i)=>{if(i&&M(t))switch(r){case"sign":if(function(e){return"oct"!==e.kty&&"string"==typeof e.d}(t)&&Q(e,t,r))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(function(e){return"oct"!==e.kty&&void 0===e.d}(t)&&Q(e,t,r))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!K(t))throw TypeError(Z(e,t,...H,i?"JSON Web Key":null));if("secret"===t.type)throw TypeError(`${Y(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${Y(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${Y(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${Y(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${Y(t)} instances for asymmetric algorithm encryption must be of type "public"`)};function er(e,t,r,i){t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?ee(t,r,i,e):et(t,r,i,e)}er.bind(void 0,!1);let ei=er.bind(void 0,!0),en=function(e,t,r,i,n){let s;if(void 0!==n.crit&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let a of(s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!s.has(a))throw new _(`Extension Header Parameter "${a}" is not recognized`);if(void 0===n[a])throw new e(`Extension Header Parameter "${a}" is missing`);if(s.get(a)&&void 0===i[a])throw new e(`Extension Header Parameter "${a}" MUST be integrity protected`)}return new Set(i.crit)},es=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function ea(e,t){if(!F(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return f(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new _('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return W({...e,alg:t});default:throw new _('Unsupported "kty" (Key Type) Parameter value')}}async function eo(e,t,r){let i,n;if(!F(e))throw new S("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new S('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new S("JWS Protected Header incorrect type");if(void 0===e.payload)throw new S("JWS Payload missing");if("string"!=typeof e.signature)throw new S("JWS Signature missing or incorrect type");if(void 0!==e.header&&!F(e.header))throw new S("JWS Unprotected Header incorrect type");let s={};if(e.protected)try{let t=f(e.protected);s=JSON.parse(c.decode(t))}catch{throw new S("JWS Protected Header is invalid")}if(!X(s,e.header))throw new S("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let a={...s,...e.header},o=en(S,new Map([["b64",!0]]),r?.crit,s,a),u=!0;if(o.has("b64")&&"boolean"!=typeof(u=s.b64))throw new S('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:h}=a;if("string"!=typeof h||!h)throw new S('JWS "alg" (Algorithm) Header Parameter missing or invalid');let p=r&&es("algorithms",r.algorithms);if(p&&!p.has(h))throw new v('"alg" (Algorithm) Header Parameter value not allowed');if(u){if("string"!=typeof e.payload)throw new S("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new S("JWS Payload must be a string or an Uint8Array instance");let y=!1;"function"==typeof t?(t=await t(s,e),y=!0,ei(h,t,"verify"),M(t)&&(t=await ea(t,h))):ei(h,t,"verify");let m=l(d.encode(e.protected??""),d.encode("."),"string"==typeof e.payload?d.encode(e.payload):e.payload);try{i=f(e.signature)}catch{throw new S("Failed to base64url decode the signature")}if(!await G(h,t,i,m))throw new R;if(u)try{n=f(e.payload)}catch{throw new S("Failed to base64url decode the payload")}else n="string"==typeof e.payload?d.encode(e.payload):e.payload;let g={payload:n};return(void 0!==e.protected&&(g.protectedHeader=s),void 0!==e.header&&(g.unprotectedHeader=e.header),y)?{...g,key:t}:g}async function ed(e,t,r){if(e instanceof Uint8Array&&(e=c.decode(e)),"string"!=typeof e)throw new S("Compact JWS must be a string or Uint8Array");let{0:i,1:n,2:s,length:a}=e.split(".");if(3!==a)throw new S("Invalid Compact JWS");let o=await eo({payload:n,protected:i,signature:s},t,r),d={payload:o.payload,protectedHeader:o.protectedHeader};return"function"==typeof t?{...d,key:o.key}:d}let ec=e=>Math.floor(e.getTime()/1e3),el=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,eu=e=>{let t;let r=el.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let i=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(i);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*i);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*i);break;case"day":case"days":case"d":t=Math.round(86400*i);break;case"week":case"weeks":case"w":t=Math.round(604800*i);break;default:t=Math.round(0x1e187e0*i)}return"-"===r[1]||"ago"===r[4]?-t:t},eh=e=>e.toLowerCase().replace(/^application\//,""),ep=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e))),ef=(e,t,r={})=>{let i,n;try{i=JSON.parse(c.decode(t))}catch{}if(!F(i))throw new k("JWT Claims Set must be a top-level JSON object");let{typ:s}=r;if(s&&("string"!=typeof e.typ||eh(e.typ)!==eh(s)))throw new m('unexpected "typ" JWT header value',i,"typ","check_failed");let{requiredClaims:a=[],issuer:o,subject:d,audience:l,maxTokenAge:u}=r,h=[...a];for(let e of(void 0!==u&&h.push("iat"),void 0!==l&&h.push("aud"),void 0!==d&&h.push("sub"),void 0!==o&&h.push("iss"),new Set(h.reverse())))if(!(e in i))throw new m(`missing required "${e}" claim`,i,e,"missing");if(o&&!(Array.isArray(o)?o:[o]).includes(i.iss))throw new m('unexpected "iss" claim value',i,"iss","check_failed");if(d&&i.sub!==d)throw new m('unexpected "sub" claim value',i,"sub","check_failed");if(l&&!ep(i.aud,"string"==typeof l?[l]:l))throw new m('unexpected "aud" claim value',i,"aud","check_failed");switch(typeof r.clockTolerance){case"string":n=eu(r.clockTolerance);break;case"number":n=r.clockTolerance;break;case"undefined":n=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:p}=r,f=ec(p||new Date);if((void 0!==i.iat||u)&&"number"!=typeof i.iat)throw new m('"iat" claim must be a number',i,"iat","invalid");if(void 0!==i.nbf){if("number"!=typeof i.nbf)throw new m('"nbf" claim must be a number',i,"nbf","invalid");if(i.nbf>f+n)throw new m('"nbf" claim timestamp check failed',i,"nbf","check_failed")}if(void 0!==i.exp){if("number"!=typeof i.exp)throw new m('"exp" claim must be a number',i,"exp","invalid");if(i.exp<=f-n)throw new g('"exp" claim timestamp check failed',i,"exp","check_failed")}if(u){let e=f-i.iat;if(e-n>("number"==typeof u?u:eu(u)))throw new g('"iat" claim timestamp check failed (too far in the past)',i,"iat","check_failed");if(e<0-n)throw new m('"iat" claim timestamp check failed (it should be in the past)',i,"iat","check_failed")}return i};async function ey(e,t,r){let i=await ed(e,t,r);if(i.protectedHeader.crit?.includes("b64")&&!1===i.protectedHeader.b64)throw new k("JWTs MUST NOT use unencoded payload");let n={payload:ef(i.protectedHeader,i.payload,r),protectedHeader:i.protectedHeader};return"function"==typeof t?{...n,key:i.key}:n}let em=async(e,t,r)=>{let i,n;let s=!1;"function"==typeof AbortController&&(i=new AbortController,n=setTimeout(()=>{s=!0,i.abort()},t));let a=await fetch(e.href,{signal:i?i.signal:void 0,redirect:"manual",headers:r.headers}).catch(e=>{if(s)throw new A;throw e});if(void 0!==n&&clearTimeout(n),200!==a.status)throw new y("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await a.json()}catch{throw new y("Failed to parse the JSON Web Key Set HTTP response as JSON")}};function eg(e){return F(e)}function ev(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}class e_{constructor(e){if(this._cached=new WeakMap,!function(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(eg)}(e))throw new T("JSON Web Key Set malformed");this._jwks=ev(e)}async getKey(e,t){let{alg:r,kid:i}={...e,...t?.header},n=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new _('Unsupported "alg" value for a JSON Web Key Set')}}(r),s=this._jwks.keys.filter(e=>{let t=n===e.kty;if(t&&"string"==typeof i&&(t=i===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv;break;case"Ed25519":t="Ed25519"===e.crv;break;case"EdDSA":t="Ed25519"===e.crv||"Ed448"===e.crv}return t}),{0:a,length:o}=s;if(0===o)throw new x;if(1!==o){let e=new I,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of s)try{yield await ew(t,e,r)}catch{}},e}return ew(this._cached,a,r)}}async function ew(e,t,r){let i=e.get(t)||e.set(t,{}).get(t);if(void 0===i[r]){let e=await ea({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new T("JSON Web Key Set members must be public keys");i[r]=e}return i[r]}function eb(e){let t=new e_(e),r=async(e,r)=>t.getKey(e,r);return Object.defineProperties(r,{jwks:{value:()=>ev(t._jwks),enumerable:!0,configurable:!1,writable:!1}}),r}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(s="jose/v5.10.0");let eS=Symbol();class ek{constructor(e,t){if(!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:t?.agent,headers:t?.headers},this._timeoutDuration="number"==typeof t?.timeoutDuration?t?.timeoutDuration:5e3,this._cooldownDuration="number"==typeof t?.cooldownDuration?t?.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof t?.cacheMaxAge?t?.cacheMaxAge:6e5,t?.[eS]!==void 0&&(this._cache=t?.[eS],function(e,t){return!!(!("object"!=typeof e||null===e||!("uat"in e)||"number"!=typeof e.uat||Date.now()-e.uat>=t)&&"jwks"in e&&F(e.jwks)&&Array.isArray(e.jwks.keys)&&Array.prototype.every.call(e.jwks.keys,F))}(t?.[eS],this._cacheMaxAge)&&(this._jwksTimestamp=this._cache.uat,this._local=eb(this._cache.jwks)))}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._local&&this.fresh()||await this.reload();try{return await this._local(e,t)}catch(r){if(r instanceof x&&!1===this.coolingDown())return await this.reload(),this._local(e,t);throw r}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0);let e=new Headers(this._options.headers);s&&!e.has("User-Agent")&&(e.set("User-Agent",s),this._options.headers=Object.fromEntries(e.entries())),this._pendingFetch||(this._pendingFetch=em(this._url,this._timeoutDuration,this._options).then(e=>{this._local=eb(e),this._cache&&(this._cache.uat=Date.now(),this._cache.jwks=e),this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}let eE=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:h(e)};if(!C(e))throw TypeError(D(e,...H,"Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:i,use:n,...s}=await P.subtle.exportKey("jwk",e);return s};async function eT(e){return eE(e)}let ex=async(e,t,r)=>{let i=await B(e,t,"sign");return N(e,i),new Uint8Array(await P.subtle.sign(O(e,i.algorithm),i,r))};class eI{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new S("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!X(this._protectedHeader,this._unprotectedHeader))throw new S("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let i={...this._protectedHeader,...this._unprotectedHeader},n=en(S,new Map([["b64",!0]]),t?.crit,this._protectedHeader,i),s=!0;if(n.has("b64")&&"boolean"!=typeof(s=this._protectedHeader.b64))throw new S('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:a}=i;if("string"!=typeof a||!a)throw new S('JWS "alg" (Algorithm) Header Parameter missing or invalid');ei(a,e,"sign");let o=this._payload;s&&(o=d.encode(h(o)));let u=l(r=this._protectedHeader?d.encode(h(JSON.stringify(this._protectedHeader))):d.encode(""),d.encode("."),o),p={signature:h(await ex(a,e,u)),payload:""};return s&&(p.payload=c.decode(o)),this._unprotectedHeader&&(p.header=this._unprotectedHeader),this._protectedHeader&&(p.protected=c.decode(r)),p}}class eA{constructor(e){this._flattened=new eI(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}function eR(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t}class eO{constructor(e={}){if(!F(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:eR("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:eR("setNotBefore",ec(e))}:this._payload={...this._payload,nbf:ec(new Date)+eu(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:eR("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:eR("setExpirationTime",ec(e))}:this._payload={...this._payload,exp:ec(new Date)+eu(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:ec(new Date)}:e instanceof Date?this._payload={...this._payload,iat:eR("setIssuedAt",ec(e))}:"string"==typeof e?this._payload={...this._payload,iat:eR("setIssuedAt",ec(new Date)+eu(e))}:this._payload={...this._payload,iat:eR("setIssuedAt",e)},this}}class eP extends eO{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){let r=new eA(d.encode(JSON.stringify(this._payload)));if(r.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new k("JWTs MUST NOT use unencoded payload");return r.sign(e,t)}}function eC(e){let t=e?.modulusLength??2048;if("number"!=typeof t||t<2048)throw new _("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return t}async function eN(e,t){let r,i;switch(e){case"PS256":case"PS384":case"PS512":r={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:eC(t)},i=["sign","verify"];break;case"RS256":case"RS384":case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:eC(t)},i=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":r={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:eC(t)},i=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":r={name:"ECDSA",namedCurve:"P-256"},i=["sign","verify"];break;case"ES384":r={name:"ECDSA",namedCurve:"P-384"},i=["sign","verify"];break;case"ES512":r={name:"ECDSA",namedCurve:"P-521"},i=["sign","verify"];break;case"Ed25519":r={name:"Ed25519"},i=["sign","verify"];break;case"EdDSA":{i=["sign","verify"];let e=t?.crv??"Ed25519";switch(e){case"Ed25519":case"Ed448":r={name:e};break;default:throw new _("Invalid or unsupported crv option provided")}break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{i=["deriveKey","deriveBits"];let e=t?.crv??"P-256";switch(e){case"P-256":case"P-384":case"P-521":r={name:"ECDH",namedCurve:e};break;case"X25519":case"X448":r={name:e};break;default:throw new _("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return P.subtle.generateKey(r,t?.extractable??!1,i)}async function eU(e,t){return eN(e,t)}let e$={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},ej=new Uint8Array(16),eL=[];for(let e=0;e<256;++e)eL.push((e+256).toString(16).slice(1));let eD=function(e,t,r){if(e$.randomUUID&&!t&&!e)return e$.randomUUID();let i=(e=e||{}).random??e.rng?.()??function(){if(!a){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");a=crypto.getRandomValues.bind(crypto)}return a(ej)}();if(i.length<16)throw Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=i[e];return t}return function(e,t=0){return(eL[e[t+0]]+eL[e[t+1]]+eL[e[t+2]]+eL[e[t+3]]+"-"+eL[e[t+4]]+eL[e[t+5]]+"-"+eL[e[t+6]]+eL[e[t+7]]+"-"+eL[e[t+8]]+eL[e[t+9]]+"-"+eL[e[t+10]]+eL[e[t+11]]+eL[e[t+12]]+eL[e[t+13]]+eL[e[t+14]]+eL[e[t+15]]).toLowerCase()}(i)},eZ="solidClientAuthn:",eK=["ES256","RS256"],eH={ERROR:"error",LOGIN:"login",LOGOUT:"logout",NEW_REFRESH_TOKEN:"newRefreshToken",SESSION_EXPIRED:"sessionExpired",SESSION_EXTENDED:"sessionExtended",SESSION_RESTORED:"sessionRestore",TIMEOUT_SET:"timeoutSet"},eF="openid offline_access webid";class eM{constructor(e){this.handleables=e,this.handleables=e}async getProperHandler(e){let t=await Promise.all(this.handleables.map(t=>t.canHandle(...e)));for(let e=0;e<t.length;e+=1)if(t[e])return this.handleables[e];return null}async canHandle(...e){return await this.getProperHandler(e)!==null}async handle(...e){let t=await this.getProperHandler(e);if(t)return t.handle(...e);throw Error(`[${this.constructor.name}] cannot find a suitable handler for: ${e.map(e=>{try{return JSON.stringify(e)}catch(t){return e.toString()}}).join(", ")}`)}}async function eW(e,t,r,i){let n,s;try{let{payload:s}=await ey(e,function(e,t){let r=new ek(e,void 0),i=async(e,t)=>r.getKey(e,t);return Object.defineProperties(i,{coolingDown:{get:()=>r.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>r.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>r.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>!!r._pendingFetch,enumerable:!0,configurable:!1},jwks:{value:()=>r._local?.jwks(),enumerable:!0,configurable:!1,writable:!1}}),i}(new URL(t)),{issuer:r,audience:i});n=s}catch(e){throw Error(`Token verification failed: ${e.stack}`)}if("string"==typeof n.azp&&(s=n.azp),"string"==typeof n.webid)return{webId:n.webid,clientId:s};if("string"!=typeof n.sub)throw Error(`The token ${JSON.stringify(n)} is invalid: it has no 'webid' claim and no 'sub' claim.`);try{return new URL(n.sub),{webId:n.sub,clientId:s}}catch(e){throw Error(`The token has no 'webid' claim, and its 'sub' claim of [${n.sub}] is invalid as a URL - error [${e}].`)}}function eJ(e){try{let t=new URL(e),r=!t.searchParams.has("code")&&!t.searchParams.has("state"),i=""===t.hash;return r&&i}catch(e){return!1}}function eV(e){let t=new URL(e);return t.searchParams.delete("state"),t.searchParams.delete("code"),t.searchParams.delete("error"),t.searchParams.delete("error_description"),t.searchParams.delete("iss"),t}class ez{constructor(e,t){this.storageUtility=e,this.redirector=t,this.parametersGuard=e=>void 0!==e.issuerConfiguration.grantTypesSupported&&e.issuerConfiguration.grantTypesSupported.indexOf("authorization_code")>-1&&void 0!==e.redirectUrl,this.storageUtility=e,this.redirector=t}async canHandle(e){return this.parametersGuard(e)}async handleRedirect({oidcLoginOptions:e,state:t,codeVerifier:r,targetUrl:i}){var n;if(!this.parametersGuard(e))throw Error("The authorization code grant requires a redirectUrl.");await Promise.all([this.storageUtility.setForUser(t,{sessionId:e.sessionId}),this.storageUtility.setForUser(e.sessionId,{codeVerifier:r,issuer:e.issuer.toString(),redirectUrl:e.redirectUrl,dpop:(!!e.dpop).toString(),keepAlive:("boolean"!=typeof(n=e.keepAlive)||!!n).toString()})]),this.redirector.redirect(i,{handleRedirect:e.handleRedirect})}}class eq{constructor(e){this.sessionInfoManager=e,this.sessionInfoManager=e}async canHandle(){return!0}async handle(e){await this.sessionInfoManager.clear(e)}}class eB{constructor(e){this.redirector=e,this.redirector=e}async canHandle(e,t){return(null==t?void 0:t.logoutType)==="idp"}async handle(e,t){if((null==t?void 0:t.logoutType)!=="idp")throw Error("Attempting to call idp logout handler to perform app logout");if(void 0===t.toLogoutUrl)throw Error("Cannot perform IDP logout. Did you log in using the OIDC authentication flow?");this.redirector.redirect(t.toLogoutUrl(t),{handleRedirect:t.handleRedirect})}}class eG{constructor(e,t){this.handlers=[new eq(e),new eB(t)]}async canHandle(){return!0}async handle(e,t){for(let r of this.handlers)await r.canHandle(e,t)&&await r.handle(e,t)}}function eX(){return{isLoggedIn:!1,sessionId:eD(),fetch:(...e)=>fetch(...e)}}async function eY(e,t){await Promise.all([t.deleteAllUserData(e,{secure:!1}),t.deleteAllUserData(e,{secure:!0})])}class eQ{constructor(e){this.storageUtility=e,this.storageUtility=e}update(e,t){throw Error("Not Implemented")}get(e){throw Error("Not implemented")}async getAll(){throw Error("Not implemented")}async clear(e){return eY(e,this.storageUtility)}async register(e){throw Error("Not implemented")}async getRegisteredSessionIdAll(){throw Error("Not implemented")}async clearAll(){throw Error("Not implemented")}}function e0(e){try{return new URL(e),!0}catch(e){return!1}}async function e1(e,t,r,i){let n;if(t.scopesSupported.includes("webid")&&void 0!==e.clientId&&e0(e.clientId))n={clientId:e.clientId,clientName:e.clientName,clientType:"solid-oidc"};else{if(void 0===e.clientId||e0(e.clientId))return i.getClient({sessionId:e.sessionId,clientName:e.clientName,redirectUrl:e.redirectUrl},t);n={clientId:e.clientId,clientSecret:e.clientSecret,clientName:e.clientName,clientType:"static"}}let s={clientId:n.clientId,clientType:n.clientType};return"static"===n.clientType&&(s.clientSecret=n.clientSecret),n.clientName&&(s.clientName=n.clientName),await r.setForUser(e.sessionId,s),n}let e2=(e,t)=>fetch(e,t);class e4{constructor(e,t,r,i,n){this.loginHandler=e,this.redirectHandler=t,this.logoutHandler=r,this.sessionInfoManager=i,this.issuerConfigFetcher=n,this.fetch=e2,this.logout=async(e,t)=>{await this.logoutHandler.handle(e,(null==t?void 0:t.logoutType)==="idp"?{...t,toLogoutUrl:this.boundLogout}:t),this.fetch=e2,delete this.boundLogout},this.getSessionInfo=async e=>this.sessionInfoManager.get(e),this.getAllSessionInfo=async()=>this.sessionInfoManager.getAll(),this.loginHandler=e,this.redirectHandler=t,this.logoutHandler=r,this.sessionInfoManager=i,this.issuerConfigFetcher=n}}async function e5(e,t,r){try{let[i,n,s,a,o]=await Promise.all([t.getForUser(e,"issuer",{errorIfNull:!0}),t.getForUser(e,"codeVerifier"),t.getForUser(e,"redirectUrl"),t.getForUser(e,"dpop",{errorIfNull:!0}),t.getForUser(e,"keepAlive")]);await t.deleteForUser(e,"codeVerifier");let d=await r.fetchConfig(i);return{codeVerifier:n,redirectUrl:s,issuerConfig:d,dpop:"true"===a,keepAlive:"string"!=typeof o||"true"===o}}catch(t){throw Error(`Failed to retrieve OIDC context from storage associated with session [${e}]: ${t}`)}}async function e9(e,t,r,i,n,s,a,o){void 0!==s&&await e.setForUser(t,{refreshToken:s},{secure:a}),void 0!==r&&await e.setForUser(t,{webId:r},{secure:a}),void 0!==i&&await e.setForUser(t,{clientId:i},{secure:a}),void 0!==n&&await e.setForUser(t,{isLoggedIn:n},{secure:a}),void 0!==o&&await e.setForUser(t,{publicKey:JSON.stringify(o.publicKey),privateKey:JSON.stringify(await eT(o.privateKey))},{secure:a})}class e6{constructor(e,t){this.secureStorage=e,this.insecureStorage=t,this.secureStorage=e,this.insecureStorage=t}getKey(e){return`solidClientAuthenticationUser:${e}`}async getUserData(e,t){let r=await (t?this.secureStorage:this.insecureStorage).get(this.getKey(e));if(void 0===r)return{};try{return JSON.parse(r)}catch(i){throw Error(`Data for user [${e}] in [${t?"secure":"unsecure"}] storage is corrupted - expected valid JSON, but got: ${r}`)}}async setUserData(e,t,r){await (r?this.secureStorage:this.insecureStorage).set(this.getKey(e),JSON.stringify(t))}async get(e,t){let r=await ((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).get(e);if(void 0===r&&(null==t?void 0:t.errorIfNull))throw Error(`[${e}] is not stored`);return r}async set(e,t,r){return((null==r?void 0:r.secure)?this.secureStorage:this.insecureStorage).set(e,t)}async delete(e,t){return((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).delete(e)}async getForUser(e,t,r){let i;let n=await this.getUserData(e,null==r?void 0:r.secure);if(n&&n[t]||(i=void 0),void 0===(i=n[t])&&(null==r?void 0:r.errorIfNull))throw Error(`Field [${t}] for user [${e}] is not stored`);return i||void 0}async setForUser(e,t,r){let i;try{i=await this.getUserData(e,null==r?void 0:r.secure)}catch(e){i={}}await this.setUserData(e,{...i,...t},null==r?void 0:r.secure)}async deleteForUser(e,t,r){let i=await this.getUserData(e,null==r?void 0:r.secure);delete i[t],await this.setUserData(e,i,null==r?void 0:r.secure)}async deleteAllUserData(e,t){await ((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).delete(this.getKey(e))}}class e3{constructor(){this.map={}}async get(e){return this.map[e]||void 0}async set(e,t){this.map[e]=t}async delete(e){delete this.map[e]}}class e8 extends Error{constructor(e){super(e)}}class e7 extends Error{constructor(e){super(`Invalid response from OIDC provider: missing fields ${e}`),this.missingFields=e}}class te extends Error{constructor(e,t,r){super(e),this.error=t,this.errorDescription=r}}async function tt(e,t,r){return new eP({htu:function(e){let t=new URL(e);return new URL(t.pathname,t.origin).toString()}(e),htm:t.toUpperCase(),jti:eD()}).setProtectedHeader({alg:eK[0],jwk:r.publicKey,typ:"dpop+jwt"}).setIssuedAt().sign(r.privateKey,{})}async function tr(){let{privateKey:e,publicKey:t}=await eU(eK[0]),r={privateKey:e,publicKey:await eT(t)};return[r.publicKey.alg]=eK,r}async function ti(e,t,r,i){var n;let s=new Headers(null==i?void 0:i.headers);return s.set("Authorization",`DPoP ${t}`),s.set("DPoP",await tt(e,null!==(n=null==i?void 0:i.method)&&void 0!==n?n:"get",r)),{...i,headers:s}}async function tn(e,t,r,i){if(void 0!==r)return ti(e,t,r,i);let n=new Headers(null==i?void 0:i.headers);return n.set("Authorization",`Bearer ${t}`),{...i,headers:n}}async function ts(e,t,r,i){return fetch(t,await tn(t.toString(),e,i,r))}async function ta(e,t,r){var i;let n=await e.tokenRefresher.refresh(e.sessionId,e.refreshToken,t);return null==r||r.emit(eH.SESSION_EXTENDED,null!==(i=n.expiresIn)&&void 0!==i?i:600),"string"==typeof n.refreshToken&&(null==r||r.emit(eH.NEW_REFRESH_TOKEN,n.refreshToken)),{accessToken:n.accessToken,refreshToken:n.refreshToken,expiresIn:n.expiresIn}}let to=e=>void 0!==e?e-5>0?e-5:e:600;async function td(e,t){var r;let i;let n=e,s=null==t?void 0:t.refreshOptions;if(void 0!==s){let e=async()=>{var r,a,o,d;try{let{accessToken:a,refreshToken:o,expiresIn:d}=await ta(s,t.dpopKey,t.eventEmitter);n=a,void 0!==o&&(s.refreshToken=o),clearTimeout(i),i=setTimeout(e,1e3*to(d)),null===(r=t.eventEmitter)||void 0===r||r.emit(eH.TIMEOUT_SET,i)}catch(e){e instanceof te&&(null===(a=null==t?void 0:t.eventEmitter)||void 0===a||a.emit(eH.ERROR,e.error,e.errorDescription),null===(o=null==t?void 0:t.eventEmitter)||void 0===o||o.emit(eH.SESSION_EXPIRED)),e instanceof e7&&e.missingFields.includes("access_token")&&(null===(d=null==t?void 0:t.eventEmitter)||void 0===d||d.emit(eH.SESSION_EXPIRED))}};i=setTimeout(e,1e3*to(t.expiresIn)),null===(r=t.eventEmitter)||void 0===r||r.emit(eH.TIMEOUT_SET,i)}else if(void 0!==t&&void 0!==t.eventEmitter){let e=setTimeout(()=>{t.eventEmitter.emit(eH.SESSION_EXPIRED)},1e3*to(t.expiresIn));t.eventEmitter.emit(eH.TIMEOUT_SET,e)}return async(e,r)=>{let i=await ts(n,e,r,null==t?void 0:t.dpopKey),s=!i.ok&&![401,403].includes(i.status);return i.ok||s||i.url!==e&&(null==t?void 0:t.dpopKey)!==void 0&&(i=await ts(n,i.url,r,t.dpopKey)),i}}var tc=r(53291),tl=r(94618);async function tu(e,t){var r,i,n;if(!t.registrationEndpoint)throw Error("Dynamic Registration could not be completed because the issuer has no registration endpoint.");if(!Array.isArray(t.idTokenSigningAlgValuesSupported))throw Error("The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.");let s=(i=t.idTokenSigningAlgValuesSupported,null!==(n=eK.find(e=>i.includes(e)))&&void 0!==n?n:null),a={client_name:e.clientName,application_type:"web",redirect_uris:[null===(r=e.redirectUrl)||void 0===r?void 0:r.toString()],subject_type:"public",token_endpoint_auth_method:"client_secret_basic",id_token_signed_response_alg:s,grant_types:["authorization_code","refresh_token"]},o=await fetch(t.registrationEndpoint.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(o.ok){let t=await o.json();return!function(e,t){if(void 0===e.client_id)throw Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(e)}`);if(t.redirectUrl&&(void 0===e.redirect_uris||e.redirect_uris[0]!==t.redirectUrl.toString()))throw Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(e.redirect_uris)} don't match the provided ${JSON.stringify([t.redirectUrl.toString()])}`)}(t,e),{clientId:t.client_id,clientSecret:t.client_secret,idTokenSignedResponseAlg:t.id_token_signed_response_alg,clientType:"dynamic"}}throw 400===o.status&&function(e,t){var r,i,n,s;if("invalid_redirect_uri"===e.error)throw Error(`Dynamic client registration failed: the provided redirect uri [${null===(r=t.redirectUrl)||void 0===r?void 0:r.toString()}] is invalid - ${null!==(i=e.error_description)&&void 0!==i?i:""}`);if("invalid_client_metadata"===e.error)throw Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(t)} is invalid - ${null!==(n=e.error_description)&&void 0!==n?n:""}`);throw Error(`Dynamic client registration failed: ${e.error} - ${null!==(s=e.error_description)&&void 0!==s?s:""}`)}(await o.json(),e),Error(`Dynamic client registration failed: the server returned ${o.status} ${o.statusText} - ${await o.text()}`)}function th(e){return void 0!==e.error_description&&"string"==typeof e.error_description}function tp(e,t){if(void 0!==e.error&&"string"==typeof e.error)throw new te(`Token endpoint returned error [${e.error}]${th(e)?`: ${e.error_description}`:""}${void 0!==e.error_uri&&"string"==typeof e.error_uri?` (see ${e.error_uri})`:""}`,e.error,th(e)?e.error_description:void 0);if(!(void 0!==e.access_token&&"string"==typeof e.access_token))throw new e7(["access_token"]);if(!(void 0!==e.id_token&&"string"==typeof e.id_token))throw new e7(["id_token"]);if(!(void 0!==e.token_type&&"string"==typeof e.token_type))throw new e7(["token_type"]);if(!(void 0===e.expires_in||"number"==typeof e.expires_in))throw new e7(["expires_in"]);if(!t&&"bearer"!==e.token_type.toLowerCase())throw Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${e.token_type}].`);return e}async function tf(e,t,r,i){let n;!function(e,t){if(t.grantType&&(!e.grantTypesSupported||!e.grantTypesSupported.includes(t.grantType)))throw Error(`The issuer [${e.issuer}] does not support the [${t.grantType}] grant`);if(!e.tokenEndpoint)throw Error(`This issuer [${e.issuer}] does not have a token endpoint`)}(e,r);let s={"content-type":"application/x-www-form-urlencoded"};i&&(n=await tr(),s.DPoP=await tt(e.tokenEndpoint,"POST",n)),t.clientSecret&&(s.Authorization=`Basic ${btoa(`${t.clientId}:${t.clientSecret}`)}`);let a={method:"POST",headers:s,body:new URLSearchParams({grant_type:r.grantType,redirect_uri:r.redirectUrl,code:r.code,code_verifier:r.codeVerifier,client_id:t.clientId}).toString()},o=await fetch(e.tokenEndpoint,a),d=tp(await o.json(),i),{webId:c,clientId:l}=await eW(d.id_token,e.jwksUri,e.issuer,t.clientId);return{accessToken:d.access_token,idToken:d.id_token,refreshToken:void 0!==d.refresh_token&&"string"==typeof d.refresh_token?d.refresh_token:void 0,webId:c,clientId:l,dpopKey:n,expiresIn:d.expires_in}}let ty=e=>{try{return new URL(e),!0}catch(e){return!1}};async function tm(e,t,r,i){let n;if(void 0===r.clientId)throw Error("No client ID available when trying to refresh the access token.");let s={grant_type:"refresh_token",refresh_token:e,scope:eF},a={};void 0!==i&&(a={DPoP:await tt(t.tokenEndpoint,"POST",i)});let o={};void 0!==r.clientSecret?o={Authorization:`Basic ${btoa(`${r.clientId}:${r.clientSecret}`)}`}:ty(r.clientId)&&(s.client_id=r.clientId);let d=await fetch(t.tokenEndpoint,{method:"POST",body:new URLSearchParams(s).toString(),headers:{...a,...o,"Content-Type":"application/x-www-form-urlencoded"}});try{n=await d.json()}catch(e){throw Error(`The token endpoint of issuer ${t.issuer} returned a malformed response.`)}let c=tp(n,void 0!==i),{webId:l}=await eW(c.id_token,t.jwksUri,t.issuer,r.clientId);return{accessToken:c.access_token,idToken:c.id_token,refreshToken:"string"==typeof c.refresh_token?c.refresh_token:void 0,webId:l,dpopKey:i,expiresIn:c.expires_in}}async function tg(){let e=new tl.OidcClient({response_mode:"query"});await e.clearStaleState(new tl.WebStorageStateStore({}));let t=window.localStorage,r=[];for(let e=0;e<=t.length;e+=1){let i=t.key(e);i&&(i.match(/^oidc\..+$/)||i.match(/^solidClientAuthenticationUser:.+$/))&&r.push(i)}r.forEach(e=>t.removeItem(e))}class tv extends e6{constructor(e,t){super(e,t)}}class t_ extends e4{constructor(){super(...arguments),this.login=async(e,t)=>{var r,i;await this.sessionInfoManager.clear(e.sessionId);let n=null!==(r=e.redirectUrl)&&void 0!==r?r:function(e){let t=eV(e);return(t.hash="",e.includes(`${t.origin}/`))?t.href:`${t.origin}${t.href.substring(t.origin.length+1)}`}(window.location.href);if(!eJ(n))throw Error(`${n} is not a valid redirect URL, it is either a malformed IRI, includes a hash fragment, or reserved query parameters ('code' or 'state').`);await this.loginHandler.handle({...e,redirectUrl:n,clientName:null!==(i=e.clientName)&&void 0!==i?i:e.clientId,eventEmitter:t})},this.validateCurrentSession=async e=>{let t=await this.sessionInfoManager.get(e);return void 0===t||void 0===t.clientAppId||void 0===t.issuer?null:t},this.handleIncomingRedirect=async(e,t)=>{try{let r=await this.redirectHandler.handle(e,t,void 0);return this.fetch=r.fetch.bind(window),this.boundLogout=r.getLogoutUrl,await this.cleanUrlAfterRedirect(e),{isLoggedIn:r.isLoggedIn,webId:r.webId,sessionId:r.sessionId,expirationDate:r.expirationDate,clientAppId:r.clientAppId}}catch(r){await this.cleanUrlAfterRedirect(e),t.emit(eH.ERROR,"redirect",r);return}}}async cleanUrlAfterRedirect(e){let t=eV(e).href;for(window.history.replaceState(null,"",t);window.location.href!==t;)await new Promise(e=>{setTimeout(()=>e(),1)})}}function tw(e){return"string"==typeof e.oidcIssuer}function tb(e){return"string"==typeof e.redirectUrl}class tS{constructor(e,t,r,i){this.storageUtility=e,this.oidcHandler=t,this.issuerConfigFetcher=r,this.clientRegistrar=i,this.storageUtility=e,this.oidcHandler=t,this.issuerConfigFetcher=r,this.clientRegistrar=i}async canHandle(e){return tw(e)&&tb(e)}async handle(e){if(!tw(e))throw new e8(`OidcLoginHandler requires an OIDC issuer: missing property 'oidcIssuer' in ${JSON.stringify(e)}`);if(!tb(e))throw new e8(`OidcLoginHandler requires a redirect URL: missing property 'redirectUrl' in ${JSON.stringify(e)}`);let t=await this.issuerConfigFetcher.fetchConfig(e.oidcIssuer),r=await e1(e,t,this.storageUtility,this.clientRegistrar),i={issuer:t.issuer,dpop:"dpop"===e.tokenType.toLowerCase(),...e,issuerConfiguration:t,client:r};return this.oidcHandler.handle(i)}}class tk extends ez{async handle(e){var t;let r={authority:e.issuer.toString(),client_id:e.client.clientId,client_secret:e.client.clientSecret,redirect_uri:e.redirectUrl,response_type:"code",scope:eF,filterProtocolClaims:!0,loadUserInfo:!1,code_verifier:!0,prompt:null!==(t=e.prompt)&&void 0!==t?t:"consent"},i=new tl.OidcClient(r);try{let t=await i.createSigninRequest();return await this.handleRedirect({oidcLoginOptions:e,state:t.state._id,codeVerifier:t.state._code_verifier,targetUrl:t.url.toString()})}catch(e){console.error(e)}}}let tE={issuer:{toKey:"issuer",convertToUrl:!0},authorization_endpoint:{toKey:"authorizationEndpoint",convertToUrl:!0},token_endpoint:{toKey:"tokenEndpoint",convertToUrl:!0},userinfo_endpoint:{toKey:"userinfoEndpoint",convertToUrl:!0},jwks_uri:{toKey:"jwksUri",convertToUrl:!0},registration_endpoint:{toKey:"registrationEndpoint",convertToUrl:!0},end_session_endpoint:{toKey:"endSessionEndpoint",convertToUrl:!0},scopes_supported:{toKey:"scopesSupported"},response_types_supported:{toKey:"responseTypesSupported"},response_modes_supported:{toKey:"responseModesSupported"},grant_types_supported:{toKey:"grantTypesSupported"},acr_values_supported:{toKey:"acrValuesSupported"},subject_types_supported:{toKey:"subjectTypesSupported"},id_token_signing_alg_values_supported:{toKey:"idTokenSigningAlgValuesSupported"},id_token_encryption_alg_values_supported:{toKey:"idTokenEncryptionAlgValuesSupported"},id_token_encryption_enc_values_supported:{toKey:"idTokenEncryptionEncValuesSupported"},userinfo_signing_alg_values_supported:{toKey:"userinfoSigningAlgValuesSupported"},userinfo_encryption_alg_values_supported:{toKey:"userinfoEncryptionAlgValuesSupported"},userinfo_encryption_enc_values_supported:{toKey:"userinfoEncryptionEncValuesSupported"},request_object_signing_alg_values_supported:{toKey:"requestObjectSigningAlgValuesSupported"},request_object_encryption_alg_values_supported:{toKey:"requestObjectEncryptionAlgValuesSupported"},request_object_encryption_enc_values_supported:{toKey:"requestObjectEncryptionEncValuesSupported"},token_endpoint_auth_methods_supported:{toKey:"tokenEndpointAuthMethodsSupported"},token_endpoint_auth_signing_alg_values_supported:{toKey:"tokenEndpointAuthSigningAlgValuesSupported"},display_values_supported:{toKey:"displayValuesSupported"},claim_types_supported:{toKey:"claimTypesSupported"},claims_supported:{toKey:"claimsSupported"},service_documentation:{toKey:"serviceDocumentation"},claims_locales_supported:{toKey:"claimsLocalesSupported"},ui_locales_supported:{toKey:"uiLocalesSupported"},claims_parameter_supported:{toKey:"claimsParameterSupported"},request_parameter_supported:{toKey:"requestParameterSupported"},request_uri_parameter_supported:{toKey:"requestUriParameterSupported"},require_request_uri_registration:{toKey:"requireRequestUriRegistration"},op_policy_uri:{toKey:"opPolicyUri",convertToUrl:!0},op_tos_uri:{toKey:"opTosUri",convertToUrl:!0}};class tT{constructor(e){this.storageUtility=e,this.storageUtility=e}static getLocalStorageKey(e){return`issuerConfig:${e}`}async fetchConfig(e){let t;let r=new URL(".well-known/openid-configuration",e.endsWith("/")?e:`${e}/`).href,i=await fetch(r);try{t=function(e){let t={};return Object.keys(e).forEach(r=>{tE[r]&&(t[tE[r].toKey]=e[r])}),Array.isArray(t.scopesSupported)||(t.scopesSupported=["openid"]),t}(await i.json())}catch(t){throw new e8(`[${e.toString()}] has an invalid configuration: ${t.message}`)}return await this.storageUtility.set(tT.getLocalStorageKey(e),JSON.stringify(t)),t}}async function tx(e,t){await eY(e,t),await tg()}class tI extends eQ{async get(e){let[t,r,i,n,s,a,o,d]=await Promise.all([this.storageUtility.getForUser(e,"isLoggedIn",{secure:!0}),this.storageUtility.getForUser(e,"webId",{secure:!0}),this.storageUtility.getForUser(e,"clientId",{secure:!1}),this.storageUtility.getForUser(e,"clientSecret",{secure:!1}),this.storageUtility.getForUser(e,"redirectUrl",{secure:!1}),this.storageUtility.getForUser(e,"refreshToken",{secure:!0}),this.storageUtility.getForUser(e,"issuer",{secure:!1}),this.storageUtility.getForUser(e,"tokenType",{secure:!1})]);if("string"==typeof s&&!eJ(s)){await Promise.all([this.storageUtility.deleteAllUserData(e,{secure:!1}),this.storageUtility.deleteAllUserData(e,{secure:!0})]);return}if(void 0!==d&&!("string"==typeof d&&["DPoP","Bearer"].includes(d)))throw Error(`Tokens of type [${d}] are not supported.`);if(void 0!==i||void 0!==t||void 0!==r||void 0!==a)return{sessionId:e,webId:r,isLoggedIn:"true"===t,redirectUrl:s,refreshToken:a,issuer:o,clientAppId:i,clientAppSecret:n,tokenType:null!=d?d:"DPoP"}}async clear(e){return tx(e,this.storageUtility)}}class tA{async canHandle(e){try{return new URL(e),!0}catch(t){throw Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(e){return eX()}}class tR{constructor(e,t,r,i,n){this.storageUtility=e,this.sessionInfoManager=t,this.issuerConfigFetcher=r,this.clientRegistrar=i,this.tokerRefresher=n,this.storageUtility=e,this.sessionInfoManager=t,this.issuerConfigFetcher=r,this.clientRegistrar=i,this.tokerRefresher=n}async canHandle(e){try{let t=new URL(e);return null!==t.searchParams.get("code")&&null!==t.searchParams.get("state")}catch(t){throw Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(e,t){let r;if(!await this.canHandle(e))throw Error(`AuthCodeRedirectHandler cannot handle [${e}]: it is missing one of [code, state].`);let i=new URL(e),n=i.searchParams.get("state"),s=await this.storageUtility.getForUser(n,"sessionId",{errorIfNull:!0}),{issuerConfig:a,codeVerifier:o,redirectUrl:d,dpop:c}=await e5(s,this.storageUtility,this.issuerConfigFetcher),l=i.searchParams.get("iss");if("string"==typeof l&&l!==a.issuer)throw Error(`The value of the iss parameter (${l}) does not match the issuer identifier of the authorization server (${a.issuer}). See [rfc9207](https://www.rfc-editor.org/rfc/rfc9207.html#section-2.3-3.1.1)`);if(void 0===o)throw Error(`The code verifier for session ${s} is missing from storage.`);if(void 0===d)throw Error(`The redirect URL for session ${s} is missing from storage.`);let u=await this.clientRegistrar.getClient({sessionId:s},a),h=Date.now(),p=await tf(a,u,{grantType:"authorization_code",code:i.searchParams.get("code"),codeVerifier:o,redirectUrl:d},c);window.localStorage.removeItem(`oidc.${n}`),void 0!==p.refreshToken&&(r={sessionId:s,refreshToken:p.refreshToken,tokenRefresher:this.tokerRefresher});let f=await td(p.accessToken,{dpopKey:p.dpopKey,refreshOptions:r,eventEmitter:t,expiresIn:p.expiresIn});await e9(this.storageUtility,s,p.webId,p.clientId,"true",void 0,!0);let y=await this.sessionInfoManager.get(s);if(!y)throw Error(`Could not retrieve session: [${s}].`);return Object.assign(y,{fetch:f,getLogoutUrl:function({endSessionEndpoint:e,idTokenHint:t}){if(void 0!==e)return function({state:r,postLogoutUrl:i}){return function({endSessionEndpoint:e,idTokenHint:t,postLogoutRedirectUri:r,state:i}){let n=new URL(e);return void 0!==t&&n.searchParams.append("id_token_hint",t),void 0!==r&&(n.searchParams.append("post_logout_redirect_uri",r),void 0!==i&&n.searchParams.append("state",i)),n.toString()}({endSessionEndpoint:e,idTokenHint:t,state:r,postLogoutRedirectUri:i})}}({idTokenHint:p.idToken,endSessionEndpoint:a.endSessionEndpoint}),expirationDate:"number"==typeof p.expiresIn?h+1e3*p.expiresIn:void 0})}}class tO extends eM{constructor(e){super(e)}}class tP{get storage(){return window.localStorage}async get(e){return this.storage.getItem(e)||void 0}async set(e,t){this.storage.setItem(e,t)}async delete(e){this.storage.removeItem(e)}}class tC{redirect(e,t){t&&t.handleRedirect?t.handleRedirect(e):t&&t.redirectByReplacingState?window.history.replaceState({},"",e):window.location.href=e}}class tN{constructor(e){this.storageUtility=e,this.storageUtility=e}async getClient(e,t){var r;let[i,n,s,a]=await Promise.all([this.storageUtility.getForUser(e.sessionId,"clientId",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientSecret",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientName",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientType",{secure:!1})]);if(i&&"string"==typeof(r=a)&&["dynamic","static","solid-oidc"].includes(r))return{clientId:i,clientSecret:n,clientName:s,clientType:a};try{let r=await tu(e,t),i={clientId:r.clientId,clientType:"dynamic"};return r.clientSecret&&(i.clientSecret=r.clientSecret),r.idTokenSignedResponseAlg&&(i.idTokenSignedResponseAlg=r.idTokenSignedResponseAlg),await this.storageUtility.setForUser(e.sessionId,i,{secure:!1}),r}catch(e){throw Error(`Client registration failed: [${e}]`)}}}class tU{async canHandle(e){try{return new URL(e).searchParams.has("error")}catch(t){throw Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(e,t){if(void 0!==t){let r=new URL(e),i=r.searchParams.get("error"),n=r.searchParams.get("error_description");t.emit(eH.ERROR,i,n)}return eX()}}class t${constructor(e,t,r){this.storageUtility=e,this.issuerConfigFetcher=t,this.clientRegistrar=r,this.storageUtility=e,this.issuerConfigFetcher=t,this.clientRegistrar=r}async refresh(e,t,r,i){let n=await e5(e,this.storageUtility,this.issuerConfigFetcher),s=await this.clientRegistrar.getClient({sessionId:e},n.issuerConfig);if(void 0===t)throw Error(`Session [${e}] has no refresh token to allow it to refresh its access token.`);if(n.dpop&&void 0===r)throw Error(`For session [${e}], the key bound to the DPoP access token must be provided to refresh said access token.`);let a=await tm(t,n.issuerConfig,s,r);return void 0!==a.refreshToken&&(null==i||i.emit(eH.NEW_REFRESH_TOKEN,a.refreshToken)),a}}function tj(e){let t=new e3,r=new tv(e.secureStorage||t,e.insecureStorage||new tP),i=new tT(r),n=new tN(r),s=new tI(r),a=new t$(r,i,n),o=new tC;return new t_(new tS(r,new tk(r,o),i,n),new tO([new tU,new tR(r,s,i,n,a),new tA]),new eG(s,o),s,i)}let tL=`${eZ}currentSession`,tD=`${eZ}currentUrl`;async function tZ(e,t,r){var i;let n=await t.validateCurrentSession(e);return null!==n&&(window.localStorage.setItem(tD,window.location.href),await t.login({sessionId:e,prompt:"none",oidcIssuer:n.issuer,redirectUrl:n.redirectUrl,clientId:n.clientAppId,clientSecret:n.clientAppSecret,tokenType:null!==(i=n.tokenType)&&void 0!==i?i:"DPoP"},r.events),!0)}class tK{constructor(e={},t){this.tokenRequestInProgress=!1,this.login=async e=>{var t;return await this.clientAuthentication.login({sessionId:this.info.sessionId,...e,tokenType:null!==(t=e.tokenType)&&void 0!==t?t:"DPoP"},this.events),new Promise(()=>{})},this.fetch=(e,t)=>this.clientAuthentication.fetch(e,t),this.internalLogout=async(e,t)=>{window.localStorage.removeItem(tL),await this.clientAuthentication.logout(this.info.sessionId,t),this.info.isLoggedIn=!1,e&&this.events.emit(eH.LOGOUT)},this.logout=async e=>this.internalLogout(!0,e),this.handleIncomingRedirect=async(e={})=>{var t;if(this.info.isLoggedIn)return this.info;if(this.tokenRequestInProgress)return;let r="string"==typeof e?{url:e}:e,i=null!==(t=r.url)&&void 0!==t?t:window.location.href;this.tokenRequestInProgress=!0;let n=await this.clientAuthentication.handleIncomingRedirect(i,this.events);if(function(e){return!!(null==e?void 0:e.isLoggedIn)}(n)){this.setSessionInfo(n);let e=window.localStorage.getItem(tD);null===e?this.events.emit(eH.LOGIN):(window.localStorage.removeItem(tD),this.events.emit(eH.SESSION_RESTORED,e))}else if(!0===r.restorePreviousSession){let e=window.localStorage.getItem(tL);if(null!==e&&await tZ(e,this.clientAuthentication,this))return new Promise(()=>{})}return this.tokenRequestInProgress=!1,n},this.events=new tc,e.clientAuthentication?this.clientAuthentication=e.clientAuthentication:e.secureStorage&&e.insecureStorage?this.clientAuthentication=tj({secureStorage:e.secureStorage,insecureStorage:e.insecureStorage}):this.clientAuthentication=tj({}),e.sessionInfo?this.info={sessionId:e.sessionInfo.sessionId,isLoggedIn:!1,webId:e.sessionInfo.webId,clientAppId:e.sessionInfo.clientAppId}:this.info={sessionId:null!=t?t:eD(),isLoggedIn:!1},this.events.on(eH.LOGIN,()=>window.localStorage.setItem(tL,this.info.sessionId)),this.events.on(eH.SESSION_EXPIRED,()=>this.internalLogout(!1)),this.events.on(eH.ERROR,()=>this.internalLogout(!1))}setSessionInfo(e){this.info.isLoggedIn=e.isLoggedIn,this.info.webId=e.webId,this.info.sessionId=e.sessionId,this.info.clientAppId=e.clientAppId,this.info.expirationDate=e.expirationDate,this.events.on(eH.SESSION_EXTENDED,e=>{this.info.expirationDate=Date.now()+1e3*e})}}function tH(){return void 0===o&&(o=new tK),o}let tF=(...e)=>tH().login(...e)},17644:(e,t,r)=>{let i;r.d(t,{YO:()=>eV,Yj:()=>eN,g1:()=>eQ,k5:()=>e9,z:()=>tc}),function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),i={};for(let e of r)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(ti||(ti={})),(tn||(tn={})).mergeShapes=(e,t)=>({...e,...t});let n=ti.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),s=e=>{switch(typeof e){case"undefined":return n.undefined;case"string":return n.string;case"number":return isNaN(e)?n.nan:n.number;case"boolean":return n.boolean;case"function":return n.function;case"bigint":return n.bigint;case"symbol":return n.symbol;case"object":if(Array.isArray(e))return n.array;if(null===e)return n.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return n.promise;if("undefined"!=typeof Map&&e instanceof Map)return n.map;if("undefined"!=typeof Set&&e instanceof Set)return n.set;if("undefined"!=typeof Date&&e instanceof Date)return n.date;return n.object;default:return n.unknown}},a=ti.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class o extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},i=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(i);else if("invalid_return_type"===n.code)i(n.returnTypeError);else if("invalid_arguments"===n.code)i(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,i=0;for(;i<n.path.length;){let r=n.path[i];i===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],i++}}};return i(this),r}static assert(e){if(!(e instanceof o))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ti.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}o.create=e=>new o(e);let d=(e,t)=>{let r;switch(e.code){case a.invalid_type:r=e.received===n.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case a.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,ti.jsonStringifyReplacer)}`;break;case a.unrecognized_keys:r=`Unrecognized key(s) in object: ${ti.joinValues(e.keys,", ")}`;break;case a.invalid_union:r="Invalid input";break;case a.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ti.joinValues(e.options)}`;break;case a.invalid_enum_value:r=`Invalid enum value. Expected ${ti.joinValues(e.options)}, received '${e.received}'`;break;case a.invalid_arguments:r="Invalid function arguments";break;case a.invalid_return_type:r="Invalid function return type";break;case a.invalid_date:r="Invalid date";break;case a.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:ti.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case a.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case a.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case a.custom:r="Invalid input";break;case a.invalid_intersection_types:r="Intersection results could not be merged";break;case a.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case a.not_finite:r="Number must be finite";break;default:r=t.defaultError,ti.assertNever(e)}return{message:r}},c=d;function l(){return c}let u=e=>{let{data:t,path:r,errorMaps:i,issueData:n}=e,s=[...r,...n.path||[]],a={...n,path:s};if(void 0!==n.message)return{...n,path:s,message:n.message};let o="";for(let e of i.filter(e=>!!e).slice().reverse())o=e(a,{data:t,defaultError:o}).message;return{...n,path:s,message:o}};function h(e,t){let r=l(),i=u({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===d?void 0:d].filter(e=>!!e)});e.common.issues.push(i)}class p{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if("aborted"===i.status)return f;"dirty"===i.status&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,i=await e.value;r.push({key:t,value:i})}return p.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:t,value:n}=i;if("aborted"===t.status||"aborted"===n.status)return f;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==n.value||i.alwaysSet)&&(r[t.value]=n.value)}return{status:e.value,value:r}}}let f=Object.freeze({status:"aborted"}),y=e=>({status:"dirty",value:e}),m=e=>({status:"valid",value:e}),g=e=>"aborted"===e.status,v=e=>"dirty"===e.status,_=e=>"valid"===e.status,w=e=>"undefined"!=typeof Promise&&e instanceof Promise;function b(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function S(e,t,r,i,n){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(ts||(ts={}));class k{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let E=(e,t)=>{if(_(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new o(e.common.issues);return this._error=t,this._error}}};function T(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:i,description:n}=e;if(t&&(r||i))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{var s,a;let{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:n.defaultError}:void 0===n.data?{message:null!==(s=null!=o?o:i)&&void 0!==s?s:n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:null!==(a=null!=o?o:r)&&void 0!==a?a:n.defaultError}},description:n}}class x{get description(){return this._def.description}_getType(e){return s(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:s(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new p,ctx:{common:e.parent.common,data:e.data,parsedType:s(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(w(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;let i={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)},n=this._parseSync({data:e,path:i.path,parent:i});return E(i,n)}"~validate"(e){var t,r;let i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)};if(!this["~standard"].async)try{let t=this._parseSync({data:e,path:[],parent:i});return _(t)?{value:t.value}:{issues:i.common.issues}}catch(e){(null===(r=null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase())||void 0===r?void 0:r.includes("encountered"))&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(e=>_(e)?{value:e.value}:{issues:i.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)},i=this._parse({data:e,path:r.path,parent:r});return E(r,await (w(i)?i:Promise.resolve(i)))}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,i)=>{let n=e(t),s=()=>i.addIssue({code:a.custom,...r(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(s(),!1)):!!n||(s(),!1)})}refinement(e,t){return this._refinement((r,i)=>!!e(r)||(i.addIssue("function"==typeof t?t(r,i):t),!1))}_refinement(e){return new ew({schema:this,typeName:td.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return eb.create(this,this._def)}nullable(){return eS.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ei.create(this)}promise(){return e_.create(this,this._def)}or(e){return es.create([this,e],this._def)}and(e){return ed.create(this,e,this._def)}transform(e){return new ew({...T(this._def),schema:this,typeName:td.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ek({...T(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:td.ZodDefault})}brand(){return new eI({typeName:td.ZodBranded,type:this,...T(this._def)})}catch(e){return new eE({...T(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:td.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return eA.create(this,e)}readonly(){return eR.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let I=/^c[^\s-]{8,}$/i,A=/^[0-9a-z]+$/,R=/^[0-9A-HJKMNP-TV-Z]{26}$/i,O=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,P=/^[a-z0-9_-]{21}$/i,C=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,N=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,j=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,L=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,D=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Z=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,K=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,H="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",F=RegExp(`^${H}$`);function M(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function W(e){let t=`${H}T${M(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class J extends x{_parse(e){var t,r,s,o;let d;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==n.string){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.string,received:t.parsedType}),f}let c=new p;for(let n of this._def.checks)if("min"===n.kind)e.data.length<n.value&&(h(d=this._getOrReturnCtx(e,d),{code:a.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),c.dirty());else if("max"===n.kind)e.data.length>n.value&&(h(d=this._getOrReturnCtx(e,d),{code:a.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),c.dirty());else if("length"===n.kind){let t=e.data.length>n.value,r=e.data.length<n.value;(t||r)&&(d=this._getOrReturnCtx(e,d),t?h(d,{code:a.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&h(d,{code:a.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),c.dirty())}else if("email"===n.kind)U.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"email",code:a.invalid_string,message:n.message}),c.dirty());else if("emoji"===n.kind)i||(i=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),i.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"emoji",code:a.invalid_string,message:n.message}),c.dirty());else if("uuid"===n.kind)O.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"uuid",code:a.invalid_string,message:n.message}),c.dirty());else if("nanoid"===n.kind)P.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"nanoid",code:a.invalid_string,message:n.message}),c.dirty());else if("cuid"===n.kind)I.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"cuid",code:a.invalid_string,message:n.message}),c.dirty());else if("cuid2"===n.kind)A.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"cuid2",code:a.invalid_string,message:n.message}),c.dirty());else if("ulid"===n.kind)R.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"ulid",code:a.invalid_string,message:n.message}),c.dirty());else if("url"===n.kind)try{new URL(e.data)}catch(t){h(d=this._getOrReturnCtx(e,d),{validation:"url",code:a.invalid_string,message:n.message}),c.dirty()}else"regex"===n.kind?(n.regex.lastIndex=0,n.regex.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"regex",code:a.invalid_string,message:n.message}),c.dirty())):"trim"===n.kind?e.data=e.data.trim():"includes"===n.kind?e.data.includes(n.value,n.position)||(h(d=this._getOrReturnCtx(e,d),{code:a.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),c.dirty()):"toLowerCase"===n.kind?e.data=e.data.toLowerCase():"toUpperCase"===n.kind?e.data=e.data.toUpperCase():"startsWith"===n.kind?e.data.startsWith(n.value)||(h(d=this._getOrReturnCtx(e,d),{code:a.invalid_string,validation:{startsWith:n.value},message:n.message}),c.dirty()):"endsWith"===n.kind?e.data.endsWith(n.value)||(h(d=this._getOrReturnCtx(e,d),{code:a.invalid_string,validation:{endsWith:n.value},message:n.message}),c.dirty()):"datetime"===n.kind?W(n).test(e.data)||(h(d=this._getOrReturnCtx(e,d),{code:a.invalid_string,validation:"datetime",message:n.message}),c.dirty()):"date"===n.kind?F.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{code:a.invalid_string,validation:"date",message:n.message}),c.dirty()):"time"===n.kind?RegExp(`^${M(n)}$`).test(e.data)||(h(d=this._getOrReturnCtx(e,d),{code:a.invalid_string,validation:"time",message:n.message}),c.dirty()):"duration"===n.kind?N.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"duration",code:a.invalid_string,message:n.message}),c.dirty()):"ip"===n.kind?(t=e.data,("v4"===(r=n.version)||!r)&&$.test(t)||("v6"===r||!r)&&L.test(t)||(h(d=this._getOrReturnCtx(e,d),{validation:"ip",code:a.invalid_string,message:n.message}),c.dirty())):"jwt"===n.kind?!function(e,t){if(!C.test(e))return!1;try{let[r]=e.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));if("object"!=typeof n||null===n||!n.typ||!n.alg||t&&n.alg!==t)return!1;return!0}catch(e){return!1}}(e.data,n.alg)&&(h(d=this._getOrReturnCtx(e,d),{validation:"jwt",code:a.invalid_string,message:n.message}),c.dirty()):"cidr"===n.kind?(s=e.data,("v4"===(o=n.version)||!o)&&j.test(s)||("v6"===o||!o)&&D.test(s)||(h(d=this._getOrReturnCtx(e,d),{validation:"cidr",code:a.invalid_string,message:n.message}),c.dirty())):"base64"===n.kind?Z.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"base64",code:a.invalid_string,message:n.message}),c.dirty()):"base64url"===n.kind?K.test(e.data)||(h(d=this._getOrReturnCtx(e,d),{validation:"base64url",code:a.invalid_string,message:n.message}),c.dirty()):ti.assertNever(n);return{status:c.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:a.invalid_string,...ts.errToObj(r)})}_addCheck(e){return new J({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ts.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ts.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ts.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ts.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ts.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ts.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ts.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ts.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ts.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ts.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ts.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ts.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ts.errToObj(e)})}datetime(e){var t,r;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(r=null==e?void 0:e.local)&&void 0!==r&&r,...ts.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...ts.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ts.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ts.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...ts.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ts.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ts.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ts.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ts.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ts.errToObj(t)})}nonempty(e){return this.min(1,ts.errToObj(e))}trim(){return new J({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new J({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new J({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}J.create=e=>{var t;return new J({checks:[],typeName:td.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...T(e)})};class V extends x{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==n.number){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.number,received:t.parsedType}),f}let r=new p;for(let i of this._def.checks)"int"===i.kind?ti.isInteger(e.data)||(h(t=this._getOrReturnCtx(e,t),{code:a.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(h(t=this._getOrReturnCtx(e,t),{code:a.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(h(t=this._getOrReturnCtx(e,t),{code:a.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"multipleOf"===i.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i;return parseInt(e.toFixed(n).replace(".",""))%parseInt(t.toFixed(n).replace(".",""))/Math.pow(10,n)}(e.data,i.value)&&(h(t=this._getOrReturnCtx(e,t),{code:a.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(h(t=this._getOrReturnCtx(e,t),{code:a.not_finite,message:i.message}),r.dirty()):ti.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ts.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ts.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ts.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ts.toString(t))}setLimit(e,t,r,i){return new V({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:ts.toString(i)}]})}_addCheck(e){return new V({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ts.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ts.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ts.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ts.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ts.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ts.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ts.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ts.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ts.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&ti.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}V.create=e=>new V({checks:[],typeName:td.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...T(e)});class z extends x{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch(t){return this._getInvalidInput(e)}if(this._getType(e)!==n.bigint)return this._getInvalidInput(e);let r=new p;for(let i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(h(t=this._getOrReturnCtx(e,t),{code:a.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(h(t=this._getOrReturnCtx(e,t),{code:a.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(h(t=this._getOrReturnCtx(e,t),{code:a.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):ti.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.bigint,received:t.parsedType}),f}gte(e,t){return this.setLimit("min",e,!0,ts.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ts.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ts.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ts.toString(t))}setLimit(e,t,r,i){return new z({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:ts.toString(i)}]})}_addCheck(e){return new z({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ts.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ts.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ts.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ts.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ts.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}z.create=e=>{var t;return new z({checks:[],typeName:td.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...T(e)})};class q extends x{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==n.boolean){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.boolean,received:t.parsedType}),f}return m(e.data)}}q.create=e=>new q({typeName:td.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...T(e)});class B extends x{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==n.date){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.date,received:t.parsedType}),f}if(isNaN(e.data.getTime()))return h(this._getOrReturnCtx(e),{code:a.invalid_date}),f;let r=new p;for(let i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(h(t=this._getOrReturnCtx(e,t),{code:a.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(h(t=this._getOrReturnCtx(e,t),{code:a.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ti.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new B({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ts.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ts.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}B.create=e=>new B({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:td.ZodDate,...T(e)});class G extends x{_parse(e){if(this._getType(e)!==n.symbol){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.symbol,received:t.parsedType}),f}return m(e.data)}}G.create=e=>new G({typeName:td.ZodSymbol,...T(e)});class X extends x{_parse(e){if(this._getType(e)!==n.undefined){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.undefined,received:t.parsedType}),f}return m(e.data)}}X.create=e=>new X({typeName:td.ZodUndefined,...T(e)});class Y extends x{_parse(e){if(this._getType(e)!==n.null){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.null,received:t.parsedType}),f}return m(e.data)}}Y.create=e=>new Y({typeName:td.ZodNull,...T(e)});class Q extends x{constructor(){super(...arguments),this._any=!0}_parse(e){return m(e.data)}}Q.create=e=>new Q({typeName:td.ZodAny,...T(e)});class ee extends x{constructor(){super(...arguments),this._unknown=!0}_parse(e){return m(e.data)}}ee.create=e=>new ee({typeName:td.ZodUnknown,...T(e)});class et extends x{_parse(e){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.never,received:t.parsedType}),f}}et.create=e=>new et({typeName:td.ZodNever,...T(e)});class er extends x{_parse(e){if(this._getType(e)!==n.undefined){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.void,received:t.parsedType}),f}return m(e.data)}}er.create=e=>new er({typeName:td.ZodVoid,...T(e)});class ei extends x{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==n.array)return h(t,{code:a.invalid_type,expected:n.array,received:t.parsedType}),f;if(null!==i.exactLength){let e=t.data.length>i.exactLength.value,n=t.data.length<i.exactLength.value;(e||n)&&(h(t,{code:e?a.too_big:a.too_small,minimum:n?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(h(t,{code:a.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(h(t,{code:a.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>i.type._parseAsync(new k(t,e,t.path,r)))).then(e=>p.mergeArray(r,e));let s=[...t.data].map((e,r)=>i.type._parseSync(new k(t,e,t.path,r)));return p.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new ei({...this._def,minLength:{value:e,message:ts.toString(t)}})}max(e,t){return new ei({...this._def,maxLength:{value:e,message:ts.toString(t)}})}length(e,t){return new ei({...this._def,exactLength:{value:e,message:ts.toString(t)}})}nonempty(e){return this.min(1,e)}}ei.create=(e,t)=>new ei({type:e,minLength:null,maxLength:null,exactLength:null,typeName:td.ZodArray,...T(t)});class en extends x{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=ti.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==n.object){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.object,received:t.parsedType}),f}let{status:t,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof et&&"strip"===this._def.unknownKeys))for(let e in r.data)s.includes(e)||o.push(e);let d=[];for(let e of s){let t=i[e],n=r.data[e];d.push({key:{status:"valid",value:e},value:t._parse(new k(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof et){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of o)d.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)o.length>0&&(h(r,{code:a.unrecognized_keys,keys:o}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of o){let i=r.data[t];d.push({key:{status:"valid",value:t},value:e._parse(new k(r,i,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of d){let r=await t.key,i=await t.value;e.push({key:r,value:i,alwaysSet:t.alwaysSet})}return e}).then(e=>p.mergeObjectSync(t,e)):p.mergeObjectSync(t,d)}get shape(){return this._def.shape()}strict(e){return ts.errToObj,new en({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var i,n,s,a;let o=null!==(s=null===(n=(i=this._def).errorMap)||void 0===n?void 0:n.call(i,t,r).message)&&void 0!==s?s:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=ts.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new en({...this._def,unknownKeys:"strip"})}passthrough(){return new en({...this._def,unknownKeys:"passthrough"})}extend(e){return new en({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new en({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:td.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new en({...this._def,catchall:e})}pick(e){let t={};return ti.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new en({...this._def,shape:()=>t})}omit(e){let t={};return ti.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new en({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof en){let r={};for(let i in t.shape){let n=t.shape[i];r[i]=eb.create(e(n))}return new en({...t._def,shape:()=>r})}return t instanceof ei?new ei({...t._def,type:e(t.element)}):t instanceof eb?eb.create(e(t.unwrap())):t instanceof eS?eS.create(e(t.unwrap())):t instanceof ec?ec.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};return ti.objectKeys(this.shape).forEach(r=>{let i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}),new en({...this._def,shape:()=>t})}required(e){let t={};return ti.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof eb;)e=e._def.innerType;t[r]=e}}),new en({...this._def,shape:()=>t})}keyof(){return em(ti.objectKeys(this.shape))}}en.create=(e,t)=>new en({shape:()=>e,unknownKeys:"strip",catchall:et.create(),typeName:td.ZodObject,...T(t)}),en.strictCreate=(e,t)=>new en({shape:()=>e,unknownKeys:"strict",catchall:et.create(),typeName:td.ZodObject,...T(t)}),en.lazycreate=(e,t)=>new en({shape:e,unknownKeys:"strip",catchall:et.create(),typeName:td.ZodObject,...T(t)});class es extends x{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new o(e.ctx.common.issues));return h(t,{code:a.invalid_union,unionErrors:r}),f});{let e;let i=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},s=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&i.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=i.map(e=>new o(e));return h(t,{code:a.invalid_union,unionErrors:n}),f}}get options(){return this._def.options}}es.create=(e,t)=>new es({options:e,typeName:td.ZodUnion,...T(t)});let ea=e=>{if(e instanceof ef)return ea(e.schema);if(e instanceof ew)return ea(e.innerType());if(e instanceof ey)return[e.value];if(e instanceof eg)return e.options;if(e instanceof ev)return ti.objectValues(e.enum);if(e instanceof ek)return ea(e._def.innerType);if(e instanceof X)return[void 0];else if(e instanceof Y)return[null];else if(e instanceof eb)return[void 0,...ea(e.unwrap())];else if(e instanceof eS)return[null,...ea(e.unwrap())];else if(e instanceof eI)return ea(e.unwrap());else if(e instanceof eR)return ea(e.unwrap());else if(e instanceof eE)return ea(e._def.innerType);else return[]};class eo extends x{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==n.object)return h(t,{code:a.invalid_type,expected:n.object,received:t.parsedType}),f;let r=this.discriminator,i=t.data[r],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(h(t,{code:a.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),f)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let r of t){let t=ea(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let n of t){if(i.has(n))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);i.set(n,r)}}return new eo({typeName:td.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...T(r)})}}class ed extends x{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=(e,i)=>{if(g(e)||g(i))return f;let o=function e(t,r){let i=s(t),a=s(r);if(t===r)return{valid:!0,data:t};if(i===n.object&&a===n.object){let i=ti.objectKeys(r),n=ti.objectKeys(t).filter(e=>-1!==i.indexOf(e)),s={...t,...r};for(let i of n){let n=e(t[i],r[i]);if(!n.valid)return{valid:!1};s[i]=n.data}return{valid:!0,data:s}}if(i===n.array&&a===n.array){if(t.length!==r.length)return{valid:!1};let i=[];for(let n=0;n<t.length;n++){let s=e(t[n],r[n]);if(!s.valid)return{valid:!1};i.push(s.data)}return{valid:!0,data:i}}return i===n.date&&a===n.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,i.value);return o.valid?((v(e)||v(i))&&t.dirty(),{status:t.value,value:o.data}):(h(r,{code:a.invalid_intersection_types}),f)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>i(e,t)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ed.create=(e,t,r)=>new ed({left:e,right:t,typeName:td.ZodIntersection,...T(r)});class ec extends x{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==n.array)return h(r,{code:a.invalid_type,expected:n.array,received:r.parsedType}),f;if(r.data.length<this._def.items.length)return h(r,{code:a.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),f;!this._def.rest&&r.data.length>this._def.items.length&&(h(r,{code:a.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...r.data].map((e,t)=>{let i=this._def.items[t]||this._def.rest;return i?i._parse(new k(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(i).then(e=>p.mergeArray(t,e)):p.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ec({...this._def,rest:e})}}ec.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new ec({items:e,typeName:td.ZodTuple,rest:null,...T(t)})};class el extends x{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==n.object)return h(r,{code:a.invalid_type,expected:n.object,received:r.parsedType}),f;let i=[],s=this._def.keyType,o=this._def.valueType;for(let e in r.data)i.push({key:s._parse(new k(r,e,r.path,e)),value:o._parse(new k(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?p.mergeObjectAsync(t,i):p.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return new el(t instanceof x?{keyType:e,valueType:t,typeName:td.ZodRecord,...T(r)}:{keyType:J.create(),valueType:e,typeName:td.ZodRecord,...T(t)})}}class eu extends x{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==n.map)return h(r,{code:a.invalid_type,expected:n.map,received:r.parsedType}),f;let i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([e,t],n)=>({key:i._parse(new k(r,e,r.path,[n,"key"])),value:s._parse(new k(r,t,r.path,[n,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of o){let i=await r.key,n=await r.value;if("aborted"===i.status||"aborted"===n.status)return f;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of o){let i=r.key,n=r.value;if("aborted"===i.status||"aborted"===n.status)return f;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}}}}eu.create=(e,t,r)=>new eu({valueType:t,keyType:e,typeName:td.ZodMap,...T(r)});class eh extends x{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==n.set)return h(r,{code:a.invalid_type,expected:n.set,received:r.parsedType}),f;let i=this._def;null!==i.minSize&&r.data.size<i.minSize.value&&(h(r,{code:a.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&r.data.size>i.maxSize.value&&(h(r,{code:a.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let s=this._def.valueType;function o(e){let r=new Set;for(let i of e){if("aborted"===i.status)return f;"dirty"===i.status&&t.dirty(),r.add(i.value)}return{status:t.value,value:r}}let d=[...r.data.values()].map((e,t)=>s._parse(new k(r,e,r.path,t)));return r.common.async?Promise.all(d).then(e=>o(e)):o(d)}min(e,t){return new eh({...this._def,minSize:{value:e,message:ts.toString(t)}})}max(e,t){return new eh({...this._def,maxSize:{value:e,message:ts.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}eh.create=(e,t)=>new eh({valueType:e,minSize:null,maxSize:null,typeName:td.ZodSet,...T(t)});class ep extends x{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==n.function)return h(t,{code:a.invalid_type,expected:n.function,received:t.parsedType}),f;function r(e,r){return u({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,l(),d].filter(e=>!!e),issueData:{code:a.invalid_arguments,argumentsError:r}})}function i(e,r){return u({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,l(),d].filter(e=>!!e),issueData:{code:a.invalid_return_type,returnTypeError:r}})}let s={errorMap:t.common.contextualErrorMap},c=t.data;if(this._def.returns instanceof e_){let e=this;return m(async function(...t){let n=new o([]),a=await e._def.args.parseAsync(t,s).catch(e=>{throw n.addIssue(r(t,e)),n}),d=await Reflect.apply(c,this,a);return await e._def.returns._def.type.parseAsync(d,s).catch(e=>{throw n.addIssue(i(d,e)),n})})}{let e=this;return m(function(...t){let n=e._def.args.safeParse(t,s);if(!n.success)throw new o([r(t,n.error)]);let a=Reflect.apply(c,this,n.data),d=e._def.returns.safeParse(a,s);if(!d.success)throw new o([i(a,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ep({...this._def,args:ec.create(e).rest(ee.create())})}returns(e){return new ep({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new ep({args:e||ec.create([]).rest(ee.create()),returns:t||ee.create(),typeName:td.ZodFunction,...T(r)})}}class ef extends x{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ef.create=(e,t)=>new ef({getter:e,typeName:td.ZodLazy,...T(t)});class ey extends x{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return h(t,{received:t.data,code:a.invalid_literal,expected:this._def.value}),f}return{status:"valid",value:e.data}}get value(){return this._def.value}}function em(e,t){return new eg({values:e,typeName:td.ZodEnum,...T(t)})}ey.create=(e,t)=>new ey({value:e,typeName:td.ZodLiteral,...T(t)});class eg extends x{constructor(){super(...arguments),ta.set(this,void 0)}_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return h(t,{expected:ti.joinValues(r),received:t.parsedType,code:a.invalid_type}),f}if(b(this,ta,"f")||S(this,ta,new Set(this._def.values),"f"),!b(this,ta,"f").has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return h(t,{received:t.data,code:a.invalid_enum_value,options:r}),f}return m(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return eg.create(e,{...this._def,...t})}exclude(e,t=this._def){return eg.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}ta=new WeakMap,eg.create=em;class ev extends x{constructor(){super(...arguments),to.set(this,void 0)}_parse(e){let t=ti.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==n.string&&r.parsedType!==n.number){let e=ti.objectValues(t);return h(r,{expected:ti.joinValues(e),received:r.parsedType,code:a.invalid_type}),f}if(b(this,to,"f")||S(this,to,new Set(ti.getValidEnumValues(this._def.values)),"f"),!b(this,to,"f").has(e.data)){let e=ti.objectValues(t);return h(r,{received:r.data,code:a.invalid_enum_value,options:e}),f}return m(e.data)}get enum(){return this._def.values}}to=new WeakMap,ev.create=(e,t)=>new ev({values:e,typeName:td.ZodNativeEnum,...T(t)});class e_ extends x{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==n.promise&&!1===t.common.async?(h(t,{code:a.invalid_type,expected:n.promise,received:t.parsedType}),f):m((t.parsedType===n.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}e_.create=(e,t)=>new e_({type:e,typeName:td.ZodPromise,...T(t)});class ew extends x{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===td.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,n={addIssue:e=>{h(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===i.type){let e=i.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return f;let i=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===i.status?f:"dirty"===i.status||"dirty"===t.value?y(i.value):i});{if("aborted"===t.value)return f;let i=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===i.status?f:"dirty"===i.status||"dirty"===t.value?y(i.value):i}}if("refinement"===i.type){let e=e=>{let t=i.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?f:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===i.status?f:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}}if("transform"===i.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>_(e)?Promise.resolve(i.transform(e.value,n)).then(e=>({status:t.value,value:e})):e);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!_(e))return e;let s=i.transform(e.value,n);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}}ti.assertNever(i)}}ew.create=(e,t,r)=>new ew({schema:e,typeName:td.ZodEffects,effect:t,...T(r)}),ew.createWithPreprocess=(e,t,r)=>new ew({schema:t,effect:{type:"preprocess",transform:e},typeName:td.ZodEffects,...T(r)});class eb extends x{_parse(e){return this._getType(e)===n.undefined?m(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eb.create=(e,t)=>new eb({innerType:e,typeName:td.ZodOptional,...T(t)});class eS extends x{_parse(e){return this._getType(e)===n.null?m(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eS.create=(e,t)=>new eS({innerType:e,typeName:td.ZodNullable,...T(t)});class ek extends x{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===n.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ek.create=(e,t)=>new ek({innerType:e,typeName:td.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...T(t)});class eE extends x{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return w(i)?i.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new o(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}eE.create=(e,t)=>new eE({innerType:e,typeName:td.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...T(t)});class eT extends x{_parse(e){if(this._getType(e)!==n.nan){let t=this._getOrReturnCtx(e);return h(t,{code:a.invalid_type,expected:n.nan,received:t.parsedType}),f}return{status:"valid",value:e.data}}}eT.create=e=>new eT({typeName:td.ZodNaN,...T(e)});let ex=Symbol("zod_brand");class eI extends x{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class eA extends x{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?f:"dirty"===e.status?(t.dirty(),y(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?f:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new eA({in:e,out:t,typeName:td.ZodPipeline})}}class eR extends x{_parse(e){let t=this._def.innerType._parse(e),r=e=>(_(e)&&(e.value=Object.freeze(e.value)),e);return w(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function eO(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function eP(e,t={},r){return e?Q.create().superRefine((i,n)=>{var s,a;let o=e(i);if(o instanceof Promise)return o.then(e=>{var s,a;if(!e){let e=eO(t,i),o=null===(a=null!==(s=e.fatal)&&void 0!==s?s:r)||void 0===a||a;n.addIssue({code:"custom",...e,fatal:o})}});if(!o){let e=eO(t,i),o=null===(a=null!==(s=e.fatal)&&void 0!==s?s:r)||void 0===a||a;n.addIssue({code:"custom",...e,fatal:o})}}):Q.create()}eR.create=(e,t)=>new eR({innerType:e,typeName:td.ZodReadonly,...T(t)});let eC={object:en.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(td||(td={}));let eN=J.create,eU=V.create,e$=eT.create,ej=z.create,eL=q.create,eD=B.create,eZ=G.create,eK=X.create,eH=Y.create,eF=Q.create,eM=ee.create,eW=et.create,eJ=er.create,eV=ei.create,ez=en.create,eq=en.strictCreate,eB=es.create,eG=eo.create,eX=ed.create,eY=ec.create,eQ=el.create,e0=eu.create,e1=eh.create,e2=ep.create,e4=ef.create,e5=ey.create,e9=eg.create,e6=ev.create,e3=e_.create,e8=ew.create,e7=eb.create,te=eS.create,tt=ew.createWithPreprocess,tr=eA.create;var ti,tn,ts,ta,to,td,tc=Object.freeze({__proto__:null,defaultErrorMap:d,setErrorMap:function(e){c=e},getErrorMap:l,makeIssue:u,EMPTY_PATH:[],addIssueToContext:h,ParseStatus:p,INVALID:f,DIRTY:y,OK:m,isAborted:g,isDirty:v,isValid:_,isAsync:w,get util(){return ti},get objectUtil(){return tn},ZodParsedType:n,getParsedType:s,ZodType:x,datetimeRegex:W,ZodString:J,ZodNumber:V,ZodBigInt:z,ZodBoolean:q,ZodDate:B,ZodSymbol:G,ZodUndefined:X,ZodNull:Y,ZodAny:Q,ZodUnknown:ee,ZodNever:et,ZodVoid:er,ZodArray:ei,ZodObject:en,ZodUnion:es,ZodDiscriminatedUnion:eo,ZodIntersection:ed,ZodTuple:ec,ZodRecord:el,ZodMap:eu,ZodSet:eh,ZodFunction:ep,ZodLazy:ef,ZodLiteral:ey,ZodEnum:eg,ZodNativeEnum:ev,ZodPromise:e_,ZodEffects:ew,ZodTransformer:ew,ZodOptional:eb,ZodNullable:eS,ZodDefault:ek,ZodCatch:eE,ZodNaN:eT,BRAND:ex,ZodBranded:eI,ZodPipeline:eA,ZodReadonly:eR,custom:eP,Schema:x,ZodSchema:x,late:eC,get ZodFirstPartyTypeKind(){return td},coerce:{string:e=>J.create({...e,coerce:!0}),number:e=>V.create({...e,coerce:!0}),boolean:e=>q.create({...e,coerce:!0}),bigint:e=>z.create({...e,coerce:!0}),date:e=>B.create({...e,coerce:!0})},any:eF,array:eV,bigint:ej,boolean:eL,date:eD,discriminatedUnion:eG,effect:e8,enum:e9,function:e2,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>eP(t=>t instanceof e,t),intersection:eX,lazy:e4,literal:e5,map:e0,nan:e$,nativeEnum:e6,never:eW,null:eH,nullable:te,number:eU,object:ez,oboolean:()=>eL().optional(),onumber:()=>eU().optional(),optional:e7,ostring:()=>eN().optional(),pipeline:tr,preprocess:tt,promise:e3,record:eQ,set:e1,strictObject:eq,string:eN,symbol:eZ,transformer:e8,tuple:eY,undefined:eK,union:eB,unknown:eM,void:eJ,NEVER:f,ZodIssueCode:a,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:o})}}]);